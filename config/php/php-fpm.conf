; PHP-FPM 性能和安全優化配置
; 符合 PHP 8.2 最佳實踐和主流 IT 企業標準

[www]
; 進程管理配置（性能優化）
pm = dynamic
pm.max_children = 20
pm.start_servers = 5
pm.min_spare_servers = 3
pm.max_spare_servers = 8
pm.max_requests = 500

; 進程優先級（性能優化）
pm.process_idle_timeout = 10s

; 請求超時
request_terminate_timeout = 300s

; 安全配置
; 限制 PHP 可以訪問的目錄
php_admin_value[open_basedir] = /var/www/html

; 禁用危險函數（安全）
php_admin_value[disable_functions] = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source

; 日誌配置
php_admin_value[error_log] = /var/log/php-fpm-error.log
php_admin_flag[log_errors] = on

; 會話安全
php_admin_value[session.cookie_httponly] = 1
php_admin_value[session.cookie_secure] = 0  ; 生產環境應設為 1（需要 HTTPS）
php_admin_value[session.use_strict_mode] = 1

; 環境變數
clear_env = no
